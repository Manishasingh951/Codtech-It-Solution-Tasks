import pandas as pd
import matplotlib.pyplot as plt
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
from datetime import datetime


def load_data(file_path):
    return pd.read_csv(file_path)


def analyze_data(df):
    summary = df.describe(include='all')
    missing = df.isnull().sum()
    return summary, missing


def plot_chart(df, output_path):
    df.select_dtypes(include='number').hist(figsize=(10, 8))
    plt.tight_layout()
    plt.savefig(output_path)
    plt.close()


def create_pdf_report(summary, missing, chart_path, output_path):
    c = canvas.Canvas(output_path, pagesize=letter)
    width, height = letter

    
    c.setFont("Helvetica-Bold", 20)
    c.drawString(200, height - 50, "Automated Data Report")

    
    c.setFont("Helvetica", 12)
    c.drawString(30, height - 80, f"Generated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")

    
    c.setFont("Helvetica-Bold", 14)
    c.drawString(30, height - 120, "Summary Statistics:")
    c.setFont("Helvetica", 10)

    text_obj = c.beginText(30, height - 140)
    for line in summary.to_string().split('\n'):
        text_obj.textLine(line)
    c.drawText(text_obj)

    
    c.setFont("Helvetica-Bold", 14)
    c.drawString(30, 200, "Missing Values:")
    c.setFont("Helvetica", 10)
    text_obj2 = c.beginText(30, 180)
    for line in missing.to_string().split('\n'):
        text_obj2.textLine(line)
    c.drawText(text_obj2)

    # Add chart image
    c.drawImage(chart_path, 100, 250, width=400, preserveAspectRatio=True)

    c.save()


def main():
    csv_file = "your_data.csv"           
    chart_output = "chart.png"
    report_output = "report.pdf"

    df = load_data(csv_file)
    summary, missing = analyze_data(df)
    plot_chart(df, chart_output)
    create_pdf_report(summary, missing, chart_output, report_output)
    print("Report generated successfully:", report_output)

if __name__ == "__main__":
    main()

